% 1kHZ - 1MHz
clear
freq = [10;11.2200000000000;12.5900000000000;14.1300000000000;15.8500000000000;17.7800000000000;19.9500000000000;22.3900000000000;25.1200000000000;28.1800000000000;31.6200000000000;35.4800000000000;39.8100000000000;44.6700000000000;50.1200000000000;56.2300000000000;63.1000000000000;70.8000000000000;79.4300000000000;89.1300000000000;100;112.200000000000;125.900000000000;141.300000000000;158.500000000000;177.800000000000;199.500000000000;223.900000000000;251.200000000000;281.800000000000;316.200000000000;354.800000000000;398.100000000000;446.700000000000;501.200000000000;562.300000000000;631;708;794.300000000000;891.300000000000;1000;1122;1259;1413;1585;1778;1995;2239;2512;2818;3162;3548;3981;4467;5012;5623;6310;7080;7943;8913;10000;11220;12590;14130;15850;17780;19950;22390;25120;28180;31620;35480;39810;44670;50120;56230;63100;70800;79430;89130;100000;112200;125900;141300;158500;177800;199500;223900;251200;281800;316200;354800;398100;446700;501200;562300;631000;708000;794300;891300;1000000;1122000;1259000;1413000;1585000;1778000;1995000;2239000;2512000;2818000;3162000;3548000;3981000;4467000;5012000;5623000;6310000;7080000;7943000;8913000;10000000;11220000;12590000;14130000;15850000;17780000;19950000;22390000;25120000;28180000;31620000;35480000;39810000;44670000;50120000;56230000;63100000;70800000;79430000;89130000;100000000;112200000;125900000;141300000;158500000;177800000;199500000;223900000;251200000;281800000;316200000;354800000;398100000;446700000;501200000;562300000;631000000;708000000;794300000;891300000;1000000000.00000;1122000000.00000;1259000000.00000;1413000000.00000;1585000000.00000;1778000000.00000;1995000000.00000;2239000000.00000;2512000000.00000;2818000000.00000;3162000000.00000;3548000000.00000;3981000000.00000;4467000000.00000;5012000000.00000;5623000000.00000;6310000000.00000;7080000000.00000;7943000000.00000;8913000000.00000;10000000000.0000;11220000000.0000;12590000000.0000;14130000000.0000;15850000000.0000;17780000000.0000;19950000000.0000;22390000000.0000;25120000000.0000;28180000000.0000;31620000000.0000;35480000000.0000;39810000000.0000;44670000000.0000;50120000000.0000;56230000000.0000;63100000000.0000;70800000000.0000;79430000000.0000;89130000000.0000;100000000000.000];
for i=1:length(freq)
    all_tissues = getTissues_mod(freq(i));
    Heart_complex(i) = all_tissues.Heart_combined;
    Muscle_complex(i) = all_tissues.Muscle_combined;
    LungDef_complex(i) = all_tissues.LungDeflated_combined;
    LungInf_complex(i) = all_tissues.LungInflated_combined;
    BoneCortical_complex(i) = all_tissues.BoneAussen_combined;
    % Vitreous Humor - Body Fluid
end

figure
clear title xlabel ylabel legend
set(gcf, 'Position', [100, 100, 1440, 700],'Color','white');
hold all;

plot(real(Heart_complex(41:101)), 100*imag(Heart_complex(41:101)), '-.g',...
    'LineWidth',2)
plot(real(Muscle_complex(41:101)), 100*imag(Muscle_complex(41:101)), '-.b',...
    'LineWidth',2)
plot(real(LungDef_complex(41:101)), 100*imag(LungDef_complex(41:101)), '-.m',...
    'LineWidth',2)
plot(real(LungInf_complex(41:101)), 100*imag(LungInf_complex(41:101)), '-.k',...
    'LineWidth',2)
plot(real(BoneCortical_complex(41:101)), 100*imag(BoneCortical_complex(41:101)), '-.c',...
    'LineWidth',2)
%plot(real(BodyFluid_complex(41:101)), 100*imag(BodyFluid_complex(41:101)), '-.m',...
%    'LineWidth',2)


plot(real(Heart_complex(81)), 100*imag(Heart_complex(81)), 'o',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',6)%'MarkerFaceColor',[.49 1 .63],...
plot(real(Heart_complex(98)), 100*imag(Heart_complex(98)), 'x',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',8)%'MarkerFaceColor',[.49 1 .63],...

plot(real(Muscle_complex(81)), 100*imag(Muscle_complex(81)), 'o',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',6)%'MarkerFaceColor',[.49 1 .63],...
plot(real(Muscle_complex(98)), 100*imag(Muscle_complex(98)), 'x',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',8)%'MarkerFaceColor',[.49 1 .63],...

plot(real(LungDef_complex(81)), 100*imag(LungDef_complex(81)), 'o',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',6)%'MarkerFaceColor',[.49 1 .63],...
plot(real(LungDef_complex(98)), 100*imag(LungDef_complex(98)), 'x',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',8)%'MarkerFaceColor',[.49 1 .63],...

plot(real(LungInf_complex(81)), 100*imag(LungInf_complex(81)), 'o',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',6)%'MarkerFaceColor',[.49 1 .63],...
plot(real(LungInf_complex(98)), 100*imag(LungInf_complex(98)), 'x',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',8)%'MarkerFaceColor',[.49 1 .63],...

plot(real(BoneCortical_complex(81)), 100*imag(BoneCortical_complex(81)), 'o',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',6)%'MarkerFaceColor',[.49 1 .63],...
plot(real(BoneCortical_complex(98)), 100*imag(BoneCortical_complex(98)), 'x',...
    'LineWidth',1.5,...
    'MarkerEdgeColor','r',...
    'MarkerSize',8)%'MarkerFaceColor',[.49 1 .63],...

p1 = [real(Heart_complex(81)) 100*imag(Heart_complex(81))];                      
p2 = [real(Heart_complex(98)) 100*imag(Heart_complex(98))];
arrow(p1, p2,'LineWidth',1.5,'Color','g','length',10);
%dp = p2-p1;                         % Difference
%quiver(p1(1),p1(2),dp(1),dp(2),0,'MaxHeadSize',0.5,'LineWidth',2)

p1 = [real(Muscle_complex(81)) 100*imag(Muscle_complex(81))];                      
p2 = [real(Muscle_complex(98)) 100*imag(Muscle_complex(98))];
arrow(p1, p2,'LineWidth',1.5,'Color','b','length',10);

% p1 = [0 0];                      
% p2 = [real(Muscle_complex(61)) imag(Muscle_complex(61))]; 
% arrow(p1, p2,'LineWidth',1.5,'Color','b','length',10,'LineStyle',':');
% p1 = [0 0];                
% p2 = [real(Muscle_complex(98)) imag(Muscle_complex(98))];
% arrow(p1, p2,'LineWidth',1.5,'Color','b','length',10,'LineStyle',':');


p1 = [real(LungDef_complex(81)) 100*imag(LungDef_complex(81))];                      
p2 = [real(LungDef_complex(98)) 100*imag(LungDef_complex(98))];
arrow(p1, p2,'LineWidth',1.5,'Color','m','length',10);


%p1 = [0 0];                      
%p2 = [real(LungInf_complex(61)) 100*imag(LungInf_complex(61))]; 
%arrow(p1, p2,'LineWidth',1.5,'Color','k','length',10,'LineStyle',':');
%p1 = [0 0];                
%p2 = [real(LungInf_complex(98)) 100*imag(LungInf_complex(98))];
%arrow(p1, p2,'LineWidth',1.5,'Color','k','length',10,'LineStyle',':');

p1 = [real(LungInf_complex(81)) 100*imag(LungInf_complex(81))];                      
p2 = [real(LungInf_complex(98)) 100*imag(LungInf_complex(98))];
arrow(p1, p2,'LineWidth',1.5,'Color','k','length',10);

p1 = [real(BoneCortical_complex(81)) 100*imag(BoneCortical_complex(81))];                      
p2 = [real(BoneCortical_complex(98)) 100*imag(BoneCortical_complex(98))];
arrow(p1, p2,'LineWidth',1.5,'Color','c','length',10);


grid
%axis([0  10    0  10])
%text(p1(1),p1(2), sprintf('(%.0f,%.0f)',p1))
%text(p2(1),p2(2), sprintf('(%.0f,%.0f)',p2))
axis([0 0.52 0 12]);
xlabel('$\Re{\{\gamma(\omega)\}}$ [S\,m]','Interpreter','latex');
ylabel('$\Im{\{\gamma(\omega)\}}\cdot 10^{-2}$ [S\,m]','Interpreter','latex');

lgd = legend('Heart', 'Muscle', 'Lung deflated', 'Lung inflated', 'Bone cortical', '100 kHz', '700 kHz');
set(lgd,'Interpreter','latex','location','northwest');
fSize=18;
set(lgd,'FontSize',fSize);
set(gca,'FontSize',fSize)

matlab2tikz('tikz/tissueProperties_conductivity.tikz');

figure
p1 = [real(Heart_complex(81)) imag(Heart_complex(81))];                      
p2 = [real(Heart_complex(98)) imag(Heart_complex(98))];
arrow([0 0], p2-p1,'LineWidth',1.5,'Color','g','length',10);
%dp = p2-p1;                         % Difference
%quiver(p1(1),p1(2),dp(1),dp(2),0,'MaxHeadSize',0.5,'LineWidth',2)

p1 = [real(Muscle_complex(81)) imag(Muscle_complex(81))];                      
p2 = [real(Muscle_complex(98)) imag(Muscle_complex(98))];
arrow([0 0], p2-p1,'LineWidth',1.5,'Color','b','length',10);

p1 = [real(LungDef_complex(81)) imag(LungDef_complex(81))];                      
p2 = [real(LungDef_complex(98)) imag(LungDef_complex(98))];
arrow([0 0], p2-p1,'LineWidth',1.5,'Color','m','length',10);

p1 = [real(BoneCortical_complex(81)) imag(BoneCortical_complex(81))];                      
p2 = [real(BoneCortical_complex(98)) imag(BoneCortical_complex(98))];
arrow([0 0], p2-p1,'LineWidth',1.5,'Color','k','length',10);

grid
